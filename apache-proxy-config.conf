<VirtualHost *:80>

  ServerAdmin me@domain.com
  ServerName concorso.capitalelavoro.it

  # Log files
  ErrorLog /gfstorage/logs/httpd/concorso/error.log
  LogLevel warn
  CustomLog /gfstorage/logs/httpd/concorso/access.log combined

  # Abilita il proxy
  ProxyPreserveHost On
  ProxyRequests Off
  ProxyTimeout 300

  # Proxy verso Next.js sulla porta 3000
  ProxyPass / http://localhost:3000/
  ProxyPassReverse / http://localhost:3000/

  # WebSocket support per Next.js hot reload (dev mode)
  RewriteEngine on
  RewriteCond %{HTTP:Upgrade} websocket [NC]
  RewriteCond %{HTTP:Connection} upgrade [NC]
  RewriteRule ^/?(.*) "ws://localhost:3000/$1" [P,L]

  # Permessi
  <Proxy *>
    Order allow,deny
    Allow from all
  </Proxy>

</VirtualHost>
